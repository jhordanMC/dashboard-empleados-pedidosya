<!DOCTYPE html>
<!-- saved from url=(0070)file:///C:/Users/Jhonathan%20Guevara/Desktop/ALBA%20KPIs/ALBAKPIs.html -->
<html lang="es"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard de Métricas de Agentes</title>
    <script src="./Dashboard de Métricas de Agentes_files/chart.min.js.descarga"></script>
    <script src="./Dashboard de Métricas de Agentes_files/papaparse.min.js.descarga"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #540000, #800000);
            min-height: 100vh;
            color: #333;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .login-form, .upload-form {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 15px 35px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 400px;
        }

        .header {
            background: rgba(255,255,255,0.95);
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .header h1 {
            color: #540000;
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header .user-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 15px;
        }

        .btn {
            background: linear-gradient(45deg, #540000, #800000);
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(84,0,0,0.3);
        }

        .btn-secondary {
            background: linear-gradient(45deg, #666, #888);
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #540000;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        .input-group input:focus {
            outline: none;
            border-color: #540000;
        }

        .dashboard {
            display: none;
        }

        .metrics-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .metric-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .metric-card h3 {
            color: #540000;
            margin-bottom: 15px;
            font-size: 1.2em;
        }

        .charts-container {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .chart-card {
            background: white;
            padding: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .chart-canvas {
            max-height: 400px;
        }

        .agents-table {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .table-header {
            background: #540000;
            color: white;
            padding: 20px;
        }

        .table-content {
            max-height: 500px;
            overflow-y: auto;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #540000;
            color: white;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .sat-critical {
            background-color: #ffebee;
            color: #d32f2f;
            font-weight: bold;
        }

        .sat-medium {
            background-color: #fff3e0;
            color: #f57c00;
            font-weight: bold;
        }

        .sat-perfect {
            background-color: #e8f5e8;
            color: #388e3c;
            font-weight: bold;
        }

        .upload-area {
            border: 2px dashed #540000;
            border-radius: 10px;
            padding: 40px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            margin-bottom: 20px;
        }

        .upload-area:hover {
            background-color: #f5f5f5;
        }

        .hidden {
            display: none;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .alert-error {
            background-color: #ffebee;
            color: #d32f2f;
            border: 1px solid #ffcdd2;
        }

        .alert-success {
            background-color: #e8f5e8;
            color: #388e3c;
            border: 1px solid #c8e6c9;
        }

        @media (max-width: 768px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 2em;
            }
        }
    </style>
<script>window.savedUserData = {"username":"admin","role":"admin","name":"Administrador","email":"admin","timestamp":1750716492471};</script><script id="savedAgentsData">
                    window.savedAgentsData = {"data":[{"agente":"maryuri.ruiz_apx.ext@pedidosya.com","qChats":2077,"sat":62.94,"aht":486.7745665,"wut":19.04576108,"frt":11.1603274,"fcr":0.8074501574,"insat":0.2444089457,"tmr":23.28233352},{"agente":"andrea.cruz_apx.ext@pedidosya.com","qChats":1603,"sat":62.64,"aht":339.2640449,"wut":14.11173533,"frt":20.06487835,"fcr":0.8419312169,"insat":0.2436823105,"tmr":24.027894},{"agente":"john.rodriguez_apx.ext@pedidosya.com","qChats":1314,"sat":62.21,"aht":287.1683168,"wut":13.72429551,"frt":22.65677321,"fcr":0.8606158833,"insat":0.2580645161,"tmr":14.41429802},{"agente":"sol.quispe_apx.ext@pedidosya.com","qChats":2358,"sat":61.92,"aht":436.4321459,"wut":12.07336726,"frt":19.82866836,"fcr":0.8118545128,"insat":0.2525641026,"tmr":18.64874031},{"agente":"victor.cabanillas_apx.ext@pedidosya.com","qChats":2322,"sat":61.78,"aht":337.0698276,"wut":20.22198276,"frt":12.47114556,"fcr":0.7700282752,"insat":0.2671927847,"tmr":19.94135338},{"agente":"jhordan.medina_apx.ext@pedidosya.com","qChats":2226,"sat":61.03,"aht":414.2659766,"wut":26.96759676,"frt":19.55705301,"fcr":0.7986247544,"insat":0.2621359223,"tmr":25.29573805},{"agente":"aurelio.castro_apx.ext@pedidosya.com","qChats":2205,"sat":60.85,"aht":372.149932,"wut":28.44489796,"frt":15.41405896,"fcr":0.8036417323,"insat":0.238744884,"tmr":22.61711007},{"agente":"ana.chumpitaz_apx.ext@pedidosya.com","qChats":1079,"sat":59.94,"aht":289.6880819,"wut":9.698324022,"frt":11.15848007,"fcr":0.8273453094,"insat":0.2568807339,"tmr":15.44062153},{"agente":"gabriela.francia_apx.ext@pedidosya.com","qChats":185,"sat":59.32,"aht":402.4756757,"wut":9.972972973,"frt":19.51351351,"fcr":0.8409090909,"insat":0.3220338983,"tmr":24.41071429},{"agente":"karen.zevallos_apx.ext@pedidosya.com","qChats":1424,"sat":58.21,"aht":343.9774965,"wut":23.67932489,"frt":11.31460674,"fcr":0.7822014052,"insat":0.2778993435,"tmr":26.29243697},{"agente":"emibeth.garcia_apx.ext@pedidosya.com","qChats":1272,"sat":58.05,"aht":450.9591292,"wut":14.57661927,"frt":32.65566038,"fcr":0.8535745047,"insat":0.2804878049,"tmr":34.86895911},{"agente":"belen.chancasana_apx.ext@pedidosya.com","qChats":939,"sat":57.73,"aht":475.598081,"wut":15.36140725,"frt":19.94781683,"fcr":0.7825112108,"insat":0.2886597938,"tmr":36.59413203},{"agente":"pierre.aranda_apx.ext@pedidosya.com","qChats":1299,"sat":57.62,"aht":324.701849,"wut":8.328967643,"frt":25.86451116,"fcr":0.8492586491,"insat":0.3156732892,"tmr":18.81343943},{"agente":"yovana.cruz_apx.ext@pedidosya.com","qChats":1817,"sat":56.99,"aht":429.2290749,"wut":13.33920705,"frt":23.92239956,"fcr":0.792997543,"insat":0.2831858407,"tmr":26.83735705},{"agente":"aracelli.sulca_apx.ext@pedidosya.com","qChats":461,"sat":56.86,"aht":426.4446855,"wut":20.85032538,"frt":11.19739696,"fcr":0.8177676538,"insat":0.3137254902,"tmr":17.30455635},{"agente":"magda.cartagena_apx.ext@pedidosya.com","qChats":276,"sat":56.67,"aht":425.1847826,"wut":31.69202899,"frt":28.82971014,"fcr":0.8521400778,"insat":0.2111111111,"tmr":24.59915612},{"agente":"ariana.zena_apx.ext@pedidosya.com","qChats":1390,"sat":56.53,"aht":440.0583573,"wut":13.57276657,"frt":19.34532374,"fcr":0.7857713829,"insat":0.2545045045,"tmr":26.88306105},{"agente":"benjamin.huerta_apx.ext@pedidosya.com","qChats":960,"sat":56.46,"aht":316.9593326,"wut":11.38373306,"frt":24.703125,"fcr":0.8166849616,"insat":0.3183183183,"tmr":30.87648456},{"agente":"erika.avila_apx.ext@pedidosya.com","qChats":2175,"sat":55.16,"aht":403.7083985,"wut":8.60625575,"frt":14.6216092,"fcr":0.7827380952,"insat":0.3111739745,"tmr":28.28398314},{"agente":"geraldine.soriano_apx.ext@pedidosya.com","qChats":2233,"sat":55.13,"aht":327.076716,"wut":30.1090175,"frt":19.66636811,"fcr":0.7708830549,"insat":0.2981715893,"tmr":24.84487386},{"agente":"jorge.pusma_apx.ext@pedidosya.com","qChats":1494,"sat":55.01,"aht":292.7876758,"wut":10.87006028,"frt":18.93239625,"fcr":0.8384502924,"insat":0.3051224944,"tmr":22.20493066},{"agente":"sujey.morales_apx.ext@pedidosya.com","qChats":2507,"sat":54.82,"aht":412.2541899,"wut":17.78810854,"frt":25.93936976,"fcr":0.7935205184,"insat":0.2941176471,"tmr":30.66208531},{"agente":"carla.pazos_apx.ext@pedidosya.com","qChats":1686,"sat":54.37,"aht":298.5966785,"wut":28.23724792,"frt":13.76453144,"fcr":0.8548286604,"insat":0.3129370629,"tmr":29.50648464},{"agente":"ana.cabrera_apx.ext@pedidosya.com","qChats":2022,"sat":54.34,"aht":407.4873825,"wut":10.00346363,"frt":17.64193867,"fcr":0.7884719956,"insat":0.3342816501,"tmr":24.91431857},{"agente":"isabel.garcia_apx.ext@pedidosya.com","qChats":1510,"sat":54.25,"aht":422.1662252,"wut":33.00728477,"frt":38.04370861,"fcr":0.8293029872,"insat":0.311546841,"tmr":34.70852359},{"agente":"veronica.allauca_apx.ext@pedidosya.com","qChats":1718,"sat":54.16,"aht":491.2160745,"wut":38.45486313,"frt":23.06577416,"fcr":0.8167938931,"insat":0.3132743363,"tmr":31.45827815},{"agente":"diego.murrieta_apx.ext@pedidosya.com","qChats":2096,"sat":54,"aht":408.3497608,"wut":25.29043062,"frt":12.50333969,"fcr":0.7917297025,"insat":0.3218210361,"tmr":25.39788536},{"agente":"jazmin.huanca_apx.ext@pedidosya.com","qChats":2278,"sat":53.77,"aht":363.7205106,"wut":40.68882042,"frt":12.73046532,"fcr":0.7683858644,"insat":0.3377483444,"tmr":27.92352941},{"agente":"carlos.lobe_apx.ext@pedidosya.com","qChats":438,"sat":53.09,"aht":411.93379,"wut":16.37214612,"frt":18.28310502,"fcr":0.837535014,"insat":0.3456790123,"tmr":26.68435013},{"agente":"luz.sicha_apx.ext@pedidosya.com","qChats":1375,"sat":52.99,"aht":314.8516364,"wut":27.13236364,"frt":15.12581818,"fcr":0.8145695364,"insat":0.315920398,"tmr":22.89173061},{"agente":"luis.valdiviezo_apx.ext@pedidosya.com","qChats":1405,"sat":52.65,"aht":322.6241084,"wut":29.90228245,"frt":25.71174377,"fcr":0.7641815235,"insat":0.3081632653,"tmr":29.11941581},{"agente":"jhosept.jara_apx.ext@pedidosya.com","qChats":2275,"sat":52.58,"aht":327.4451783,"wut":16.11008366,"frt":34.71736264,"fcr":0.7957914873,"insat":0.3355978261,"tmr":29.46816098},{"agente":"karim.cueva_apx.ext@pedidosya.com","qChats":602,"sat":52.45,"aht":366.9118136,"wut":48.61730449,"frt":45.83222591,"fcr":0.8479532164,"insat":0.3235294118,"tmr":27.80632411},{"agente":"allison.rasabal_apx.ext@pedidosya.com","qChats":346,"sat":52.43,"aht":453.9534884,"wut":28.39244186,"frt":9.653179191,"fcr":0.7896341463,"insat":0.3300970874,"tmr":29.98006645},{"agente":"anthuanette.espinoza_apx.ext@pedidosya.com","qChats":1374,"sat":52.07,"aht":346.5455208,"wut":12.01238165,"frt":45.09825328,"fcr":0.7996715928,"insat":0.33640553,"tmr":37.49056604},{"agente":"xiomara.marquez_apx.ext@pedidosya.com","qChats":1902,"sat":51.97,"aht":281.054708,"wut":11.24513414,"frt":21.03785489,"fcr":0.8107019563,"insat":0.3409836066,"tmr":23.31101643},{"agente":"juliocesar.rivera_apx.ext@pedidosya.com","qChats":2390,"sat":51.94,"aht":373.480737,"wut":69.5221943,"frt":22.68995816,"fcr":0.7835144928,"insat":0.3309776207,"tmr":23.93973542},{"agente":"noelia.riega_apx.ext@pedidosya.com","qChats":1676,"sat":51.9,"aht":461.9126794,"wut":12.84748804,"frt":28.86455847,"fcr":0.7980582524,"insat":0.3544303797,"tmr":42.63937897},{"agente":"eliana.meneses_apx.ext@pedidosya.com","qChats":2189,"sat":51.65,"aht":436.929913,"wut":18.12551535,"frt":14.13750571,"fcr":0.7973040439,"insat":0.3328550933,"tmr":23.4336},{"agente":"natalia.echevarria_apx.ext@pedidosya.com","qChats":1709,"sat":51.5,"aht":354.5742807,"wut":12.94891368,"frt":36.50087771,"fcr":0.8307111391,"insat":0.3572854291,"tmr":31.09009629},{"agente":"sergio.ccopa_apx.ext@pedidosya.com","qChats":1346,"sat":51.49,"aht":420.3372957,"wut":10.6679049,"frt":13.01931649,"fcr":0.7850770479,"insat":0.3425531915,"tmr":34.5234721},{"agente":"brigitte.aguirre_apx.ext@pedidosya.com","qChats":761,"sat":51.06,"aht":411.1776316,"wut":12.37236842,"frt":28.23390276,"fcr":0.7875,"insat":0.3106382979,"tmr":21.68592593},{"agente":"omar.solano_apx.ext@pedidosya.com","qChats":2248,"sat":50.49,"aht":308.9216385,"wut":8.142475512,"frt":14.82161922,"fcr":0.8054623862,"insat":0.3422159888,"tmr":20.48333333},{"agente":"yaseily.villar_apx.ext@pedidosya.com","qChats":2016,"sat":50.39,"aht":463.9234973,"wut":18.46547442,"frt":19.65922619,"fcr":0.8007662835,"insat":0.3601895735,"tmr":33.85822637},{"agente":"jocelyn.serna_apx.ext@pedidosya.com","qChats":21,"sat":50,"aht":337.6190476,"wut":14.57142857,"frt":22.14285714,"fcr":0.6111111111,"insat":0.3333333333,"tmr":34},{"agente":"angel.castillo_apx.ext@pedidosya.com","qChats":2411,"sat":49.94,"aht":342.5458316,"wut":18.59435919,"frt":23.18871837,"fcr":0.7647058824,"insat":0.3631778058,"tmr":28.75964392},{"agente":"luis.marti_apx.ext@pedidosya.com","qChats":1154,"sat":49.87,"aht":326.1513043,"wut":15.31565217,"frt":22.57279029,"fcr":0.7834645669,"insat":0.35839599,"tmr":30.35797254},{"agente":"giancarlo.alcalde_apx.ext@pedidosya.com","qChats":2397,"sat":49.32,"aht":302.5167084,"wut":13.99122807,"frt":14.63078849,"fcr":0.7995454545,"insat":0.377027027,"tmr":24.71572074},{"agente":"judith.hinostroza_apx.ext@pedidosya.com","qChats":1702,"sat":49.32,"aht":371.3503821,"wut":10.42504409,"frt":27.25558167,"fcr":0.7632600259,"insat":0.3677966102,"tmr":33.92618384},{"agente":"estefany.denegri_apx.ext@pedidosya.com","qChats":1213,"sat":49.02,"aht":409.4542457,"wut":22.19208574,"frt":14.6438582,"fcr":0.7666362808,"insat":0.3578431373,"tmr":31.00679612},{"agente":"elizabeth.huaman_apx.ext@pedidosya.com","qChats":1856,"sat":48.48,"aht":409.4657312,"wut":13.38478144,"frt":25.47790948,"fcr":0.800232288,"insat":0.3855218855,"tmr":29.60240964},{"agente":"carlo.javes_apx.ext@pedidosya.com","qChats":1399,"sat":48.39,"aht":384.2839771,"wut":8.097997139,"frt":10.87062187,"fcr":0.7501945525,"insat":0.371559633,"tmr":24.03754266},{"agente":"maria.perez_apx.ext@pedidosya.com","qChats":1349,"sat":48.33,"aht":403.8507795,"wut":13.74684484,"frt":11.4595997,"fcr":0.7856553998,"insat":0.3429844098,"tmr":27.48010381},{"agente":"ginett.bor_apx.ext@pedidosya.com","qChats":741,"sat":48.16,"aht":304.7594595,"wut":9.554054054,"frt":14.10526316,"fcr":0.8190743338,"insat":0.3469387755,"tmr":22.04434251},{"agente":"katherine.alania_apx.ext@pedidosya.com","qChats":1843,"sat":48.14,"aht":292.0228261,"wut":11.40326087,"frt":17.97069995,"fcr":0.8149651972,"insat":0.3966101695,"tmr":23.543125},{"agente":"gonzalo.zuniga_apx.ext@pedidosya.com","qChats":1176,"sat":47.24,"aht":457.1700855,"wut":26.31880342,"frt":52.59693878,"fcr":0.7795648061,"insat":0.3778801843,"tmr":38.52306183},{"agente":"antonio.cisneros_apx.ext@pedidosya.com","qChats":1291,"sat":47.13,"aht":443.0565453,"wut":13.88613478,"frt":18.80170411,"fcr":0.794017094,"insat":0.3715710723,"tmr":38.26897844},{"agente":"katerin.miranda_apx.ext@pedidosya.com","qChats":624,"sat":47.12,"aht":433.6864952,"wut":7.993569132,"frt":11.20032051,"fcr":0.7939698492,"insat":0.3560209424,"tmr":30.5971223},{"agente":"lizette.maurtua_apx.ext@pedidosya.com","qChats":691,"sat":46.92,"aht":342.1944848,"wut":19.05079826,"frt":21.51808973,"fcr":0.75975039,"insat":0.3412322275,"tmr":26.47008547},{"agente":"milagritos.malquichagua_apx.ext@pedidosya.com","qChats":339,"sat":46.51,"aht":360.0294985,"wut":56.72861357,"frt":24.26253687,"fcr":0.7331288344,"insat":0.3953488372,"tmr":30.15100671},{"agente":"tabata.andrade_apx.ext@pedidosya.com","qChats":1225,"sat":45.64,"aht":404.752459,"wut":15.94918033,"frt":13.1477551,"fcr":0.746031746,"insat":0.4014962594,"tmr":40.37512639},{"agente":"lizet.ancajima_apx.ext@pedidosya.com","qChats":421,"sat":45.45,"aht":409.3221957,"wut":13.15274463,"frt":34.17814727,"fcr":0.8659793814,"insat":0.3712121212,"tmr":28.81666667},{"agente":"ana.robles_apx.ext@pedidosya.com","qChats":1254,"sat":45.09,"aht":403.0646449,"wut":15.13567438,"frt":11.92902711,"fcr":0.7675438596,"insat":0.3753148615,"tmr":37.70327553},{"agente":"isabel.tsuchida_apx.ext@pedidosya.com","qChats":264,"sat":43.48,"aht":407.3143939,"wut":45.08333333,"frt":16.375,"fcr":0.7704918033,"insat":0.4202898551,"tmr":27.08695652},{"agente":"sofia.ruiz_apx.ext@pedidosya.com","qChats":1265,"sat":43.09,"aht":404.59318,"wut":14.47264076,"frt":62.5083004,"fcr":0.7657894737,"insat":0.4124423963,"tmr":44.1473384},{"agente":"cesar.huaicama_apx.ext@pedidosya.com","qChats":1687,"sat":42.83,"aht":300.8559573,"wut":8.855957321,"frt":16.56016598,"fcr":0.8116591928,"insat":0.4338919926,"tmr":25.82581541},{"agente":"alejandra.castillo_apx.ext@pedidosya.com","qChats":1035,"sat":42.62,"aht":426.2468293,"wut":25.55121951,"frt":37.14782609,"fcr":0.7898550725,"insat":0.3442622951,"tmr":39.89485981},{"agente":"hector.chaparro_apx.ext@pedidosya.com","qChats":1550,"sat":41.45,"aht":287.3873467,"wut":7.424144609,"frt":13.33483871,"fcr":0.7367272727,"insat":0.4302554028,"tmr":34.32151491},{"agente":"luciana.bardales_apx.ext@pedidosya.com","qChats":983,"sat":41.29,"aht":342.6449644,"wut":24.2543235,"frt":18.03967447,"fcr":0.7505376344,"insat":0.4387096774,"tmr":35.05941846},{"agente":"fernando.martinez_apx.ext@pedidosya.com","qChats":550,"sat":33.95,"aht":237.9090909,"wut":6.467272727,"frt":18.25818182,"fcr":0.7634615385,"insat":0.4976744186,"tmr":25.77870564},{"agente":"null","qChats":0,"sat":0,"aht":0,"wut":0,"frt":0,"fcr":0,"insat":0,"tmr":0}],"timestamp":1750716501298,"version":"1.0"};
                    console.log('Datos guardados permanentemente:', window.savedAgentsData.data.length, 'agentes');
                </script></head>
<body>
    <!-- Pantalla de Login -->
    <div id="loginScreen" class="login-container" style="display: none;">
        <div class="login-form">
            <h2 style="text-align: center; color: #540000; margin-bottom: 30px;">Iniciar Sesión</h2>
            <div id="loginAlert" class="alert alert-error hidden"></div>
            <form id="loginForm">
                <div class="input-group">
                    <label for="username">Usuario:</label>
                    <input type="text" id="username" required="" placeholder="admin o nombre.apellido">
                </div>
                <div class="input-group">
                    <label for="password">Contraseña:</label>
                    <input type="password" id="password" required="" placeholder="admin123 o asesor123">
                </div>
                <button type="submit" class="btn" style="width: 100%;">Ingresar</button>
            </form>
            <div style="margin-top: 20px; padding: 15px; background: #f5f5f5; border-radius: 8px; font-size: 14px; color: #666;">
                <strong>Credenciales:</strong><br>
                <strong>Admin:</strong> admin / admin123<br>
                <strong>Asesores:</strong> nombre.apellido / asesor123
            </div>
        </div>
    </div>

    <!-- Dashboard Principal -->
    <div id="dashboardScreen" class="dashboard" style="display: block;">
        <div class="container">
            <div class="header">
                <h1>Dashboard de Métricas de Agentes</h1>
                <div class="user-info">
                    <span id="welcomeUser">Bienvenido, Administrador</span>
                    <div>
                        <button id="uploadBtn" class="btn">Cargar Datos</button>
                        <button id="logoutBtn" class="btn btn-secondary">Cerrar Sesión</button>
                    </div>
                </div>
            </div>

            <!-- Panel de Carga (Solo Administrador) -->
            <div id="uploadPanel" class="upload-form hidden" style="max-width: 600px; margin: 0 auto 30px;">
                <h3 style="text-align: center; color: #540000; margin-bottom: 20px;">Cargar Archivo de Datos</h3>
                <div id="uploadAlert" class="alert alert-success hidden">Datos procesados exitosamente. 71 agentes cargados.</div>
                <div class="upload-area" onclick="document.getElementById(&#39;csvFile&#39;).click()">
                    <p>📁 Haz clic aquí para seleccionar el archivo CSV</p>
                    <p style="font-size: 14px; color: #666; margin-top: 10px;">
                        Formato: Agente, Q Chats, SAT, AHT, WUT, FRT, FCR, INSAT, TMR
                    </p>
                </div>
                <input type="file" id="csvFile" accept=".csv" class="hidden">
                <button id="processFile" class="btn" style="width: 100%;">Procesar: Hoja de cálculo sin título - Hoja 1 (1).csv</button>
            </div>

            <!-- Métricas Generales -->
            <div class="metrics-grid">
                <div class="metric-card">
                    <h3>Total de Agentes</h3>
                    <div style="font-size: 2em; font-weight: bold; color: #540000;" id="totalAgents">71</div>
                </div>
                <div class="metric-card">
                    <h3>SAT Promedio</h3>
                    <div style="font-size: 2em; font-weight: bold; color: #540000;" id="avgSAT">51.3%</div>
                </div>
                <div class="metric-card">
                    <h3>AHT Promedio</h3>
                    <div style="font-size: 2em; font-weight: bold; color: #540000;" id="avgAHT">372.2</div>
                </div>
                <div class="metric-card">
                    <h3>FCR Promedio</h3>
                    <div style="font-size: 2em; font-weight: bold; color: #540000;" id="avgFCR">0.8%</div>
                </div>
            </div>

            <!-- Gráficos -->
            <div class="charts-container">
                <div class="chart-card">
                    <h3 style="color: #540000; margin-bottom: 15px;">Top 10 Agentes por SAT</h3>
                    <canvas id="satChart" class="chart-canvas" width="596" height="450" style="display: block; box-sizing: border-box; height: 400px; width: 529.778px;"></canvas>
                </div>
                <div class="chart-card">
                    <h3 style="color: #540000; margin-bottom: 15px;">Distribución de SAT</h3>
                    <canvas id="satDistributionChart" class="chart-canvas" width="596" height="450" style="display: block; box-sizing: border-box; height: 400px; width: 529.778px;"></canvas>
                </div>
            </div>

            <!-- Tabla de Agentes -->
            <div class="agents-table">
                <div class="table-header">
                    <h3>Ranking de Agentes por SAT</h3>
                </div>
                <div class="table-content">
                    <table>
                        <thead>
                            <tr>
                                <th>Posición</th>
                                <th>Agente</th>
                                <th>SAT (%)</th>
                                <th>Q Chats</th>
                                <th>AHT</th>
                                <th>FCR (%)</th>
                                <th>Estado</th>
                            </tr>
                        </thead>
                        <tbody id="agentsTableBody"><tr>
                        <td>1</td>
                        <td>maryuri.ruiz_apx.ext</td>
                        <td class="sat-medium">62.9%</td>
                        <td>2077</td>
                        <td>486.8</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>2</td>
                        <td>andrea.cruz_apx.ext</td>
                        <td class="sat-medium">62.6%</td>
                        <td>1603</td>
                        <td>339.3</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>3</td>
                        <td>john.rodriguez_apx.ext</td>
                        <td class="sat-medium">62.2%</td>
                        <td>1314</td>
                        <td>287.2</td>
                        <td>0.9%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>4</td>
                        <td>sol.quispe_apx.ext</td>
                        <td class="sat-medium">61.9%</td>
                        <td>2358</td>
                        <td>436.4</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>5</td>
                        <td>victor.cabanillas_apx.ext</td>
                        <td class="sat-medium">61.8%</td>
                        <td>2322</td>
                        <td>337.1</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>6</td>
                        <td>jhordan.medina_apx.ext</td>
                        <td class="sat-medium">61.0%</td>
                        <td>2226</td>
                        <td>414.3</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>7</td>
                        <td>aurelio.castro_apx.ext</td>
                        <td class="sat-medium">60.9%</td>
                        <td>2205</td>
                        <td>372.1</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>8</td>
                        <td>ana.chumpitaz_apx.ext</td>
                        <td class="sat-medium">59.9%</td>
                        <td>1079</td>
                        <td>289.7</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>9</td>
                        <td>gabriela.francia_apx.ext</td>
                        <td class="sat-medium">59.3%</td>
                        <td>185</td>
                        <td>402.5</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>10</td>
                        <td>karen.zevallos_apx.ext</td>
                        <td class="sat-medium">58.2%</td>
                        <td>1424</td>
                        <td>344.0</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>11</td>
                        <td>emibeth.garcia_apx.ext</td>
                        <td class="sat-medium">58.0%</td>
                        <td>1272</td>
                        <td>451.0</td>
                        <td>0.9%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>12</td>
                        <td>belen.chancasana_apx.ext</td>
                        <td class="sat-medium">57.7%</td>
                        <td>939</td>
                        <td>475.6</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>13</td>
                        <td>pierre.aranda_apx.ext</td>
                        <td class="sat-medium">57.6%</td>
                        <td>1299</td>
                        <td>324.7</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>14</td>
                        <td>yovana.cruz_apx.ext</td>
                        <td class="sat-medium">57.0%</td>
                        <td>1817</td>
                        <td>429.2</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>15</td>
                        <td>aracelli.sulca_apx.ext</td>
                        <td class="sat-medium">56.9%</td>
                        <td>461</td>
                        <td>426.4</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>16</td>
                        <td>magda.cartagena_apx.ext</td>
                        <td class="sat-medium">56.7%</td>
                        <td>276</td>
                        <td>425.2</td>
                        <td>0.9%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>17</td>
                        <td>ariana.zena_apx.ext</td>
                        <td class="sat-medium">56.5%</td>
                        <td>1390</td>
                        <td>440.1</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>18</td>
                        <td>benjamin.huerta_apx.ext</td>
                        <td class="sat-medium">56.5%</td>
                        <td>960</td>
                        <td>317.0</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>19</td>
                        <td>erika.avila_apx.ext</td>
                        <td class="sat-medium">55.2%</td>
                        <td>2175</td>
                        <td>403.7</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>20</td>
                        <td>geraldine.soriano_apx.ext</td>
                        <td class="sat-medium">55.1%</td>
                        <td>2233</td>
                        <td>327.1</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>21</td>
                        <td>jorge.pusma_apx.ext</td>
                        <td class="sat-medium">55.0%</td>
                        <td>1494</td>
                        <td>292.8</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>22</td>
                        <td>sujey.morales_apx.ext</td>
                        <td class="sat-medium">54.8%</td>
                        <td>2507</td>
                        <td>412.3</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>23</td>
                        <td>carla.pazos_apx.ext</td>
                        <td class="sat-medium">54.4%</td>
                        <td>1686</td>
                        <td>298.6</td>
                        <td>0.9%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>24</td>
                        <td>ana.cabrera_apx.ext</td>
                        <td class="sat-medium">54.3%</td>
                        <td>2022</td>
                        <td>407.5</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>25</td>
                        <td>isabel.garcia_apx.ext</td>
                        <td class="sat-medium">54.3%</td>
                        <td>1510</td>
                        <td>422.2</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>26</td>
                        <td>veronica.allauca_apx.ext</td>
                        <td class="sat-medium">54.2%</td>
                        <td>1718</td>
                        <td>491.2</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>27</td>
                        <td>diego.murrieta_apx.ext</td>
                        <td class="sat-medium">54.0%</td>
                        <td>2096</td>
                        <td>408.3</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>28</td>
                        <td>jazmin.huanca_apx.ext</td>
                        <td class="sat-medium">53.8%</td>
                        <td>2278</td>
                        <td>363.7</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>29</td>
                        <td>carlos.lobe_apx.ext</td>
                        <td class="sat-medium">53.1%</td>
                        <td>438</td>
                        <td>411.9</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>30</td>
                        <td>luz.sicha_apx.ext</td>
                        <td class="sat-medium">53.0%</td>
                        <td>1375</td>
                        <td>314.9</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>31</td>
                        <td>luis.valdiviezo_apx.ext</td>
                        <td class="sat-medium">52.6%</td>
                        <td>1405</td>
                        <td>322.6</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>32</td>
                        <td>jhosept.jara_apx.ext</td>
                        <td class="sat-medium">52.6%</td>
                        <td>2275</td>
                        <td>327.4</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>33</td>
                        <td>karim.cueva_apx.ext</td>
                        <td class="sat-medium">52.5%</td>
                        <td>602</td>
                        <td>366.9</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>34</td>
                        <td>allison.rasabal_apx.ext</td>
                        <td class="sat-medium">52.4%</td>
                        <td>346</td>
                        <td>454.0</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>35</td>
                        <td>anthuanette.espinoza_apx.ext</td>
                        <td class="sat-medium">52.1%</td>
                        <td>1374</td>
                        <td>346.5</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>36</td>
                        <td>xiomara.marquez_apx.ext</td>
                        <td class="sat-medium">52.0%</td>
                        <td>1902</td>
                        <td>281.1</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>37</td>
                        <td>juliocesar.rivera_apx.ext</td>
                        <td class="sat-medium">51.9%</td>
                        <td>2390</td>
                        <td>373.5</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>38</td>
                        <td>noelia.riega_apx.ext</td>
                        <td class="sat-medium">51.9%</td>
                        <td>1676</td>
                        <td>461.9</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>39</td>
                        <td>eliana.meneses_apx.ext</td>
                        <td class="sat-medium">51.6%</td>
                        <td>2189</td>
                        <td>436.9</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>40</td>
                        <td>natalia.echevarria_apx.ext</td>
                        <td class="sat-medium">51.5%</td>
                        <td>1709</td>
                        <td>354.6</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>41</td>
                        <td>sergio.ccopa_apx.ext</td>
                        <td class="sat-medium">51.5%</td>
                        <td>1346</td>
                        <td>420.3</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>42</td>
                        <td>brigitte.aguirre_apx.ext</td>
                        <td class="sat-medium">51.1%</td>
                        <td>761</td>
                        <td>411.2</td>
                        <td>0.8%</td>
                        <td class="sat-medium">Medio</td>
                    </tr><tr>
                        <td>43</td>
                        <td>omar.solano_apx.ext</td>
                        <td class="">50.5%</td>
                        <td>2248</td>
                        <td>308.9</td>
                        <td>0.8%</td>
                        <td class="">Indefinido</td>
                    </tr><tr>
                        <td>44</td>
                        <td>yaseily.villar_apx.ext</td>
                        <td class="">50.4%</td>
                        <td>2016</td>
                        <td>463.9</td>
                        <td>0.8%</td>
                        <td class="">Indefinido</td>
                    </tr><tr>
                        <td>45</td>
                        <td>jocelyn.serna_apx.ext</td>
                        <td class="">50.0%</td>
                        <td>21</td>
                        <td>337.6</td>
                        <td>0.6%</td>
                        <td class="">Indefinido</td>
                    </tr><tr>
                        <td>46</td>
                        <td>angel.castillo_apx.ext</td>
                        <td class="">49.9%</td>
                        <td>2411</td>
                        <td>342.5</td>
                        <td>0.8%</td>
                        <td class="">Indefinido</td>
                    </tr><tr>
                        <td>47</td>
                        <td>luis.marti_apx.ext</td>
                        <td class="">49.9%</td>
                        <td>1154</td>
                        <td>326.2</td>
                        <td>0.8%</td>
                        <td class="">Indefinido</td>
                    </tr><tr>
                        <td>48</td>
                        <td>giancarlo.alcalde_apx.ext</td>
                        <td class="">49.3%</td>
                        <td>2397</td>
                        <td>302.5</td>
                        <td>0.8%</td>
                        <td class="">Indefinido</td>
                    </tr><tr>
                        <td>49</td>
                        <td>judith.hinostroza_apx.ext</td>
                        <td class="">49.3%</td>
                        <td>1702</td>
                        <td>371.4</td>
                        <td>0.8%</td>
                        <td class="">Indefinido</td>
                    </tr><tr>
                        <td>50</td>
                        <td>estefany.denegri_apx.ext</td>
                        <td class="">49.0%</td>
                        <td>1213</td>
                        <td>409.5</td>
                        <td>0.8%</td>
                        <td class="">Indefinido</td>
                    </tr><tr>
                        <td>51</td>
                        <td>elizabeth.huaman_apx.ext</td>
                        <td class="">48.5%</td>
                        <td>1856</td>
                        <td>409.5</td>
                        <td>0.8%</td>
                        <td class="">Indefinido</td>
                    </tr><tr>
                        <td>52</td>
                        <td>carlo.javes_apx.ext</td>
                        <td class="">48.4%</td>
                        <td>1399</td>
                        <td>384.3</td>
                        <td>0.8%</td>
                        <td class="">Indefinido</td>
                    </tr><tr>
                        <td>53</td>
                        <td>maria.perez_apx.ext</td>
                        <td class="">48.3%</td>
                        <td>1349</td>
                        <td>403.9</td>
                        <td>0.8%</td>
                        <td class="">Indefinido</td>
                    </tr><tr>
                        <td>54</td>
                        <td>ginett.bor_apx.ext</td>
                        <td class="">48.2%</td>
                        <td>741</td>
                        <td>304.8</td>
                        <td>0.8%</td>
                        <td class="">Indefinido</td>
                    </tr><tr>
                        <td>55</td>
                        <td>katherine.alania_apx.ext</td>
                        <td class="">48.1%</td>
                        <td>1843</td>
                        <td>292.0</td>
                        <td>0.8%</td>
                        <td class="">Indefinido</td>
                    </tr><tr>
                        <td>56</td>
                        <td>gonzalo.zuniga_apx.ext</td>
                        <td class="sat-critical">47.2%</td>
                        <td>1176</td>
                        <td>457.2</td>
                        <td>0.8%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>57</td>
                        <td>antonio.cisneros_apx.ext</td>
                        <td class="sat-critical">47.1%</td>
                        <td>1291</td>
                        <td>443.1</td>
                        <td>0.8%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>58</td>
                        <td>katerin.miranda_apx.ext</td>
                        <td class="sat-critical">47.1%</td>
                        <td>624</td>
                        <td>433.7</td>
                        <td>0.8%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>59</td>
                        <td>lizette.maurtua_apx.ext</td>
                        <td class="sat-critical">46.9%</td>
                        <td>691</td>
                        <td>342.2</td>
                        <td>0.8%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>60</td>
                        <td>milagritos.malquichagua_apx.ext</td>
                        <td class="sat-critical">46.5%</td>
                        <td>339</td>
                        <td>360.0</td>
                        <td>0.7%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>61</td>
                        <td>tabata.andrade_apx.ext</td>
                        <td class="sat-critical">45.6%</td>
                        <td>1225</td>
                        <td>404.8</td>
                        <td>0.7%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>62</td>
                        <td>lizet.ancajima_apx.ext</td>
                        <td class="sat-critical">45.5%</td>
                        <td>421</td>
                        <td>409.3</td>
                        <td>0.9%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>63</td>
                        <td>ana.robles_apx.ext</td>
                        <td class="sat-critical">45.1%</td>
                        <td>1254</td>
                        <td>403.1</td>
                        <td>0.8%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>64</td>
                        <td>isabel.tsuchida_apx.ext</td>
                        <td class="sat-critical">43.5%</td>
                        <td>264</td>
                        <td>407.3</td>
                        <td>0.8%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>65</td>
                        <td>sofia.ruiz_apx.ext</td>
                        <td class="sat-critical">43.1%</td>
                        <td>1265</td>
                        <td>404.6</td>
                        <td>0.8%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>66</td>
                        <td>cesar.huaicama_apx.ext</td>
                        <td class="sat-critical">42.8%</td>
                        <td>1687</td>
                        <td>300.9</td>
                        <td>0.8%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>67</td>
                        <td>alejandra.castillo_apx.ext</td>
                        <td class="sat-critical">42.6%</td>
                        <td>1035</td>
                        <td>426.2</td>
                        <td>0.8%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>68</td>
                        <td>hector.chaparro_apx.ext</td>
                        <td class="sat-critical">41.5%</td>
                        <td>1550</td>
                        <td>287.4</td>
                        <td>0.7%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>69</td>
                        <td>luciana.bardales_apx.ext</td>
                        <td class="sat-critical">41.3%</td>
                        <td>983</td>
                        <td>342.6</td>
                        <td>0.8%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>70</td>
                        <td>fernando.martinez_apx.ext</td>
                        <td class="sat-critical">34.0%</td>
                        <td>550</td>
                        <td>237.9</td>
                        <td>0.8%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr><tr>
                        <td>71</td>
                        <td>null</td>
                        <td class="sat-critical">0.0%</td>
                        <td>0</td>
                        <td>0.0</td>
                        <td>0.0%</td>
                        <td class="sat-critical">Crítico</td>
                    </tr></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <script>
                    // Lista de asesores autorizados
        const AUTHORIZED_AGENTS = [
            'maryuri.ruiz_apx.ext@pedidosya.com',
            'jhordan.medina_apx.ext@pedidosya.com',
            'aurelio.castro_apx.ext@pedidosya.com',
            'veronica.allauca_apx.ext@pedidosya.com',
            'jazmin.huanca_apx.ext@pedidosya.com',
            'allison.rasabal_apx.ext@pedidosya.com',
            'juliocesar.rivera_apx.ext@pedidosya.com',
            'noelia.riega_apx.ext@pedidosya.com',
            'sergio.ccopa_apx.ext@pedidosya.com',
            'yaseily.villar_apx.ext@pedidosya.com',
            'angel.castillo_apx.ext@pedidosya.com',
            'luis.marti_apx.ext@pedidosya.com',
            'ginett.bor_apx.ext@pedidosya.com'
        ];

        // Sistema de autenticación y gestión de datos
        class DashboardManager {
            constructor() {
                this.currentUser = null;
                this.agentsData = [];
                this.filteredData = [];
                this.charts = {};
                this.init();
            }

            init() {
                this.setupEventListeners();
                this.checkAuthStatus();
            }

            setupEventListeners() {
                // Login
                document.getElementById('loginForm').addEventListener('submit', (e) => {
                    e.preventDefault();
                    this.handleLogin();
                });

                // Logout
                document.getElementById('logoutBtn').addEventListener('click', () => {
                    this.logout();
                });

                // Upload
                document.getElementById('uploadBtn').addEventListener('click', () => {
                    this.toggleUploadPanel();
                });

                document.getElementById('csvFile').addEventListener('change', (e) => {
                    this.handleFileSelect(e);
                });

                document.getElementById('processFile').addEventListener('click', () => {
                    this.processFile();
                });
            }

            checkAuthStatus() {
                const savedUser = this.getCurrentUser();
                if (savedUser) {
                    this.currentUser = savedUser;
                    this.showDashboard();
                } else {
                    this.showLogin();
                }
            }

            handleLogin() {
                const username = document.getElementById('username').value;
                const password = document.getElementById('password').value;

                // Usuarios del sistema
                const users = {
                    'admin': { password: 'admin123', role: 'admin', name: 'Administrador' }
                };

                // Agregar asesores autorizados como usuarios
                AUTHORIZED_AGENTS.forEach(email => {
                    const shortName = email.split('.')[0]; // Tomar primera parte del email como usuario
                    users[shortName] = { 
                        password: 'asesor123', 
                        role: 'agent', 
                        name: email.split('@')[0].replace(/\./g, ' ').toUpperCase(),
                        email: email
                    };
                    // También permitir login con email completo
                    users[email] = users[shortName];
                });

                if (users[username] && users[username].password === password) {
                    this.currentUser = {
                        username: username,
                        role: users[username].role,
                        name: users[username].name,
                        email: users[username].email || username
                    };
                    this.saveCurrentUser();
                    this.showDashboard();
                } else {
                    this.showAlert('loginAlert', 'Usuario o contraseña incorrectos', 'error');
                }
            }

            logout() {
                this.currentUser = null;
                this.clearCurrentUser();
                this.showLogin();
            }

            showLogin() {
                document.getElementById('loginScreen').style.display = 'flex';
                document.getElementById('dashboardScreen').style.display = 'none';
                document.getElementById('username').value = '';
                document.getElementById('password').value = '';
                this.hideAlert('loginAlert');
            }

            showDashboard() {
                document.getElementById('loginScreen').style.display = 'none';
                document.getElementById('dashboardScreen').style.display = 'block';
                
                document.getElementById('welcomeUser').textContent = `Bienvenido, ${this.currentUser.name}`;
                
                // Mostrar botón de carga solo para admin
                if (this.currentUser.role === 'admin') {
                    document.getElementById('uploadBtn').classList.remove('hidden');
                }

                // Cargar datos guardados si existen
                this.loadSavedData();
                
                // Si es un asesor, filtrar sus datos específicos
                if (this.currentUser.role === 'agent') {
                    this.filterAgentData();
                }
            }

            toggleUploadPanel() {
                const panel = document.getElementById('uploadPanel');
                panel.classList.toggle('hidden');
            }

            handleFileSelect(event) {
                const file = event.target.files[0];
                const processBtn = document.getElementById('processFile');
                
                if (file && file.type === 'text/csv') {
                    processBtn.disabled = false;
                    processBtn.textContent = `Procesar: ${file.name}`;
                } else {
                    processBtn.disabled = true;
                    processBtn.textContent = 'Procesar Archivo';
                    if (file) {
                        this.showAlert('uploadAlert', 'Por favor selecciona un archivo CSV válido', 'error');
                    }
                }
            }

            processFile() {
                const fileInput = document.getElementById('csvFile');
                const file = fileInput.files[0];

                if (!file) return;

                Papa.parse(file, {
                    header: true,
                    skipEmptyLines: true,
                    complete: (results) => {
                        this.processCSVData(results.data);
                    },
                    error: (error) => {
                        this.showAlert('uploadAlert', `Error al procesar el archivo: ${error.message}`, 'error');
                    }
                });
            }

            processCSVData(data) {
                try {
                    // Limpiar y validar datos
                    this.agentsData = data.map(row => ({
                        agente: row.Agente?.trim() || '',
                        qChats: parseInt(row['Q Chats']) || 0,
                        sat: parseFloat(row.SAT) || 0,
                        aht: parseFloat(row.AHT) || 0,
                        wut: parseFloat(row.WUT) || 0,
                        frt: parseFloat(row.FRT) || 0,
                        fcr: parseFloat(row.FCR) || 0,
                        insat: parseFloat(row.INSAT) || 0,
                        tmr: parseFloat(row.TMR) || 0
                    })).filter(agent => agent.agente !== '');

                    // Ordenar por SAT descendente
                    this.agentsData.sort((a, b) => b.sat - a.sat);

                    // Guardar datos permanentemente
                    this.saveAgentsData();

                    // Actualizar dashboard
                    this.updateDashboard();

                    // Ocultar panel de carga
                    document.getElementById('uploadPanel').classList.add('hidden');
                    
                    this.showAlert('uploadAlert', `Datos procesados exitosamente. ${this.agentsData.length} agentes cargados.`, 'success');

                } catch (error) {
                    this.showAlert('uploadAlert', `Error al procesar los datos: ${error.message}`, 'error');
                }
            }

            filterAgentData() {
                if (this.currentUser.role === 'agent') {
                    // Filtrar datos para el asesor específico
                    this.filteredData = this.agentsData.filter(agent => 
                        agent.agente === this.currentUser.email ||
                        agent.agente.toLowerCase().includes(this.currentUser.username.toLowerCase())
                    );
                } else {
                    this.filteredData = this.agentsData;
                }
            }

            updateDashboard() {
                // Filtrar datos según el usuario actual
                this.filterAgentData();
                
                this.updateGeneralMetrics();
                this.updateCharts();
                this.updateAgentsTable();
            }

            updateGeneralMetrics() {
                const dataToUse = this.currentUser.role === 'agent' ? this.filteredData : this.agentsData;
                const totalAgents = dataToUse.length;
                const avgSAT = totalAgents > 0 ? (dataToUse.reduce((sum, agent) => sum + agent.sat, 0) / totalAgents).toFixed(1) : 0;
                const avgAHT = totalAgents > 0 ? (dataToUse.reduce((sum, agent) => sum + agent.aht, 0) / totalAgents).toFixed(1) : 0;
                const avgFCR = totalAgents > 0 ? (dataToUse.reduce((sum, agent) => sum + agent.fcr, 0) / totalAgents).toFixed(1) : 0;

                document.getElementById('totalAgents').textContent = totalAgents;
                document.getElementById('avgSAT').textContent = avgSAT + '%';
                document.getElementById('avgAHT').textContent = avgAHT;
                document.getElementById('avgFCR').textContent = avgFCR + '%';
            }

            updateCharts() {
                this.createSATChart();
                this.createSATDistributionChart();
            }

            createSATChart() {
                const ctx = document.getElementById('satChart').getContext('2d');
                
                if (this.charts.satChart) {
                    this.charts.satChart.destroy();
                }

                const dataToUse = this.currentUser.role === 'agent' ? this.filteredData : this.agentsData.slice(0, 10);
                
                // Si es asesor y no hay datos, mostrar mensaje
                if (this.currentUser.role === 'agent' && dataToUse.length === 0) {
                    ctx.clearRect(0, 0, ctx.canvas.width, ctx.canvas.height);
                    ctx.font = '16px Arial';
                    ctx.fillStyle = '#540000';
                    ctx.textAlign = 'center';
                    ctx.fillText('No se encontraron datos para tu usuario', ctx.canvas.width/2, ctx.canvas.height/2);
                    return;
                }
                
                this.charts.satChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: dataToUse.map(agent => 
                            this.currentUser.role === 'agent' ? 'Mi SAT' : agent.agente.split('@')[0]
                        ),
                        datasets: [{
                            label: 'SAT (%)',
                            data: dataToUse.map(agent => agent.sat),
                            backgroundColor: dataToUse.map(agent => this.getSATColor(agent.sat)),
                            borderColor: '#540000',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    callback: function(value) {
                                        return value + '%';
                                    }
                                }
                            },
                            x: {
                                ticks: {
                                    maxRotation: 45
                                }
                            }
                        }
                    }
                });
            }

            createSATDistributionChart() {
                const ctx = document.getElementById('satDistributionChart').getContext('2d');
                
                if (this.charts.satDistributionChart) {
                    this.charts.satDistributionChart.destroy();
                }

                const dataToUse = this.currentUser.role === 'agent' ? this.filteredData : this.agentsData;
                
                const critical = dataToUse.filter(agent => agent.sat <= 48).length;
                const medium = dataToUse.filter(agent => agent.sat >= 51 && agent.sat < 65).length;
                const perfect = dataToUse.filter(agent => agent.sat >= 65).length;

                this.charts.satDistributionChart = new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: ['Crítico (≤48%)', 'Medio (51-64%)', 'Perfecto (≥65%)'],
                        datasets: [{
                            data: [critical, medium, perfect],
                            backgroundColor: ['#d32f2f', '#f57c00', '#388e3c'],
                            borderWidth: 2,
                            borderColor: '#540000'
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });
            }

            updateAgentsTable() {
                const tbody = document.getElementById('agentsTableBody');
                tbody.innerHTML = '';

                const dataToUse = this.currentUser.role === 'agent' ? this.filteredData : this.agentsData;

                dataToUse.forEach((agent, index) => {
                    const row = document.createElement('tr');
                    const satClass = this.getSATClass(agent.sat);
                    const displayName = this.currentUser.role === 'agent' ? 
                        agent.agente.split('@')[0] : 
                        agent.agente.length > 30 ? agent.agente.split('@')[0] : agent.agente;
                    
                    row.innerHTML = `
                        <td>${index + 1}</td>
                        <td>${displayName}</td>
                        <td class="${satClass}">${agent.sat.toFixed(1)}%</td>
                        <td>${agent.qChats}</td>
                        <td>${agent.aht.toFixed(1)}</td>
                        <td>${agent.fcr.toFixed(1)}%</td>
                        <td class="${satClass}">${this.getSATStatus(agent.sat)}</td>
                    `;
                    
                    tbody.appendChild(row);
                });

                // Si es asesor y no hay datos
                if (this.currentUser.role === 'agent' && dataToUse.length === 0) {
                    const row = document.createElement('tr');
                    row.innerHTML = `
                        <td colspan="7" style="text-align: center; padding: 20px; color: #666;">
                            No se encontraron datos para tu usuario. Contacta al administrador.
                        </td>
                    `;
                    tbody.appendChild(row);
                }
            }

            getSATClass(sat) {
                if (sat <= 48) return 'sat-critical';
                if (sat >= 51 && sat < 65) return 'sat-medium';
                if (sat >= 65) return 'sat-perfect';
                return '';
            }

            getSATStatus(sat) {
                if (sat <= 48) return 'Crítico';
                if (sat >= 51 && sat < 65) return 'Medio';
                if (sat >= 65) return 'Perfecto';
                return 'Indefinido';
            }

            getSATColor(sat) {
                if (sat <= 48) return 'rgba(211, 47, 47, 0.8)';
                if (sat >= 51 && sat < 65) return 'rgba(245, 124, 0, 0.8)';
                if (sat >= 65) return 'rgba(56, 142, 60, 0.8)';
                return 'rgba(84, 0, 0, 0.8)';
            }

            showAlert(alertId, message, type) {
                const alert = document.getElementById(alertId);
                alert.textContent = message;
                alert.className = `alert alert-${type}`;
                alert.classList.remove('hidden');
                
                setTimeout(() => {
                    this.hideAlert(alertId);
                }, 5000);
            }

            hideAlert(alertId) {
                const alert = document.getElementById(alertId);
                alert.classList.add('hidden');
            }

            // Métodos de almacenamiento permanente
            saveCurrentUser() {
                const userData = {
                    username: this.currentUser.username,
                    role: this.currentUser.role,
                    name: this.currentUser.name,
                    email: this.currentUser.email,
                    timestamp: Date.now()
                };
                // Almacenamiento persistente simulado
                window.persistentUserSession = userData;
                
                // Guardar en una variable del HTML para persistencia
                const script = document.createElement('script');
                script.textContent = `window.savedUserData = ${JSON.stringify(userData)};`;
                document.head.appendChild(script);
            }

            getCurrentUser() {
                // Intentar recuperar de múltiples fuentes
                return window.persistentUserSession || window.savedUserData || null;
            }

            clearCurrentUser() {
                window.persistentUserSession = null;
                window.savedUserData = null;
            }

            saveAgentsData() {
                const agentsData = {
                    data: this.agentsData,
                    timestamp: Date.now(),
                    version: '1.0'
                };
                
                // Almacenamiento persistente simulado
                window.persistentAgentsData = agentsData;
                
                // Crear script para persistencia en el HTML
                const script = document.createElement('script');
                script.id = 'savedAgentsData';
                script.textContent = `
                    window.savedAgentsData = ${JSON.stringify(agentsData)};
                    console.log('Datos guardados permanentemente:', window.savedAgentsData.data.length, 'agentes');
                `;
                
                // Remover script anterior si existe
                const oldScript = document.getElementById('savedAgentsData');
                if (oldScript) {
                    oldScript.remove();
                }
                
                document.head.appendChild(script);
            }

            loadSavedData() {
                // Intentar cargar de múltiples fuentes
                const savedData = window.persistentAgentsData || window.savedAgentsData;
                
                if (savedData && savedData.data && Array.isArray(savedData.data)) {
                    this.agentsData = savedData.data;
                    console.log('Datos cargados:', this.agentsData.length, 'agentes');
                    this.updateDashboard();
                } else {
                    console.log('No se encontraron datos guardados');
                    // Mostrar mensaje si no hay datos y no es admin
                    if (this.currentUser.role !== 'admin') {
                        document.getElementById('totalAgents').textContent = 'Sin datos';
                        document.getElementById('avgSAT').textContent = 'N/A';
                        document.getElementById('avgAHT').textContent = 'N/A';
                        document.getElementById('avgFCR').textContent = 'N/A';
                    }
                }
            }
        }

        // Inicializar la aplicación
        const dashboard = new DashboardManager();
    </script>

</body></html>